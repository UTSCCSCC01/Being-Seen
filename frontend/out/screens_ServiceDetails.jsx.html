<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: screens/ServiceDetails.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: screens/ServiceDetails.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import PropTypes from "prop-types";
import React, { useEffect, useState } from "react";
import {
  Button,
  Dimensions,
  FlatList,
  ImageBackground,
  Linking,
  StyleSheet,
  Text,
  TouchableOpacity,
  View,
} from "react-native";
import openMap from "react-native-open-maps";
import { Rating } from "react-native-ratings";
import { tailwind } from "tailwind";

import TagRow from "../components/TagRow";
import apiHandler from "../util/APIHandler";
import { capitalize, formatDate, openPhone } from "../util/FormatHelper";

/**
 * @function ServiceDetails displays expanded details of a service
 * @module ServiceDetails
 * @description This is a screen that displays the details of one single service.
 * @prop {object} route Must contain {query, itemId} in route.params, where query is the name of
 *                         the endpoint to which this component will send http requests
 *                         and itemId is the id of the service of interest.
 * @prop {object} navigation The navigation object provided by react navigation library.
 *
 */
export default function ServiceDetails({ route, navigation }) {
  const { query, itemId } = route.params;
  const [refreshing, setRefreshing] = useState(false);
  const [info, setInfo] = useState(null);

  useEffect(() => {
    apiHandler
      .getInfoFromApiById(query, itemId)
      .then((res) => res.json())
      .then((json) => setInfo(json))
      .catch((error) => console.log(error));
  }, []);

  async function refreshFromApi() {
    setRefreshing(true);
    const res = await apiHandler.getInfoFromApiById(query, info._id);
    if (res.status === 200) {
      res.json().then((json) => setInfo(json));
    }
    setRefreshing(false);
  }

  return (
    &lt;>
      {!info ? (
        &lt;Text>Loading...&lt;/Text>
      ) : (
        &lt;FlatList
          refreshing={refreshing}
          onRefresh={refreshFromApi}
          ListHeaderComponent={
            &lt;>
              {info.picture ? (
                &lt;ImageBackground
                  style={styles.headlinePicture}
                  source={{ uri: info.picture }}
                />
              ) : null}
              &lt;View style={styles.infoContainer}>
                &lt;Text style={styles.infoNormalText}>Name: {info.name}&lt;/Text>
                {info.address ? (
                  &lt;View style={styles.infoRow}>
                    &lt;Text style={styles.infoNormalText}>Address: &lt;/Text>
                    &lt;TouchableOpacity
                      onPress={() => {
                        openMap({ query: info.address });
                      }}
                    >
                      &lt;Text style={styles.infoUnderlinedText}>
                        {" "}
                        {info.address}
                      &lt;/Text>
                    &lt;/TouchableOpacity>
                  &lt;/View>
                ) : null}
                {info.phoneNumber ? (
                  &lt;View style={styles.infoRow}>
                    &lt;Text style={styles.infoNormalText}>Phone Number: &lt;/Text>
                    &lt;TouchableOpacity
                      onPress={() => {
                        openPhone(info.phoneNumber);
                      }}
                    >
                      &lt;Text style={styles.infoUnderlinedText} color="purple">
                        {" "}
                        {info.phoneNumber}
                      &lt;/Text>
                    &lt;/TouchableOpacity>
                  &lt;/View>
                ) : null}
                {info.email ? (
                  &lt;View style={styles.infoRow}>
                    &lt;Text style={styles.infoNormalText}>Email:&lt;/Text>
                    &lt;TouchableOpacity
                      onPress={() => {
                        Linking.openURL(`mailto:${info.email}?subject=&amp;body=`);
                      }}
                    >
                      &lt;Text style={styles.infoUnderlinedText} color="purple">
                        {" "}
                        {info.email}
                      &lt;/Text>
                    &lt;/TouchableOpacity>
                  &lt;/View>
                ) : null}
                &lt;Text style={styles.infoNormalText}>
                  &lt;Text style={styles.infoNormalText}>Description:&lt;/Text>
                  &lt;Text style={styles.infoNormalText}>{info.description}&lt;/Text>
                &lt;/Text>
                {info.hours ? (
                  &lt;Text style={styles.infoNormalText}>Hours: {info.hours}&lt;/Text>
                ) : null}
                {info.rating ? (
                  &lt;View flexDirection="row">
                    &lt;Text style={styles.infoNormalText}>Rating:&lt;/Text>
                    &lt;Rating
                      readonly="true"
                      startingValue={info.rating}
                      // tintColor={purpleThemeColour} &lt;-- TODO: Fix this styling
                      imageSize={28}
                      jumpValue={0.5}
                    />
                  &lt;/View>
                ) : null}
              &lt;/View>
              &lt;TagRow tagList={info.tags} />
              {info.reviews ? (
                &lt;Button
                  onPress={() => {
                    navigation.navigate(`Review ${capitalize(query)}`, {
                      infoId: info._id,
                      query,
                    });
                  }}
                  title="Write/Edit a Review For This Shelter"
                />
              ) : null}
              {info.website ? (
                &lt;Button
                  title="Go to website"
                  onPress={() => {
                    Linking.openURL(info.website);
                  }}
                />
              ) : null}
            &lt;/>
          }
          data={info.reviews}
          renderItem={({ item }) => (
            &lt;View style={styles.reviewBox} key={item}>
              &lt;Text style={styles.reviewText}>&amp;quot;{item.content}&amp;quot;&lt;/Text>
              &lt;View flexDirection="row">
                &lt;Text style={styles.reviewText}>Rating: &lt;/Text>
                &lt;Rating
                  readonly="true"
                  startingValue={item.rating}
                  // tintColor={purpleThemeColour} &lt;-- TODO: Fix this styling
                  imageSize={25}
                />
              &lt;/View>
              &lt;Text style={styles.reviewText}>
                Written on {formatDate(item.date)}
              &lt;/Text>
            &lt;/View>
          )}
          keyExtractor={(item) => item.reviewer.toString()}
        />
      )}
    &lt;/>
  );
}

ServiceDetails.propTypes = {
  route: PropTypes.object.isRequired,
  navigation: PropTypes.object.isRequired,
};

const styles = StyleSheet.create({
  headlinePicture: {
    height: Dimensions.get("window").height / 4,
    resizeMode: "cover",
    width: Dimensions.get("window").width,
  },
  infoContainer: {
    ...tailwind("bg-gray-100"),
    // borderRadius: 10,
    paddingHorizontal: 5,
    paddingVertical: 5,
  },
  infoNormalText: {
    ...tailwind("text-black"),
    fontSize: 16,
    margin: 2,
  },
  infoRow: {
    flexDirection: "row",
  },
  infoUnderlinedText: {
    ...tailwind("text-black"),
    fontSize: 16,
    margin: 2,
    // textDecorationColor: purpleThemeColour,
    textDecorationLine: "underline",
  },
  reviewBox: {
    ...tailwind("bg-white border-primary"),
    borderRadius: 10,
    borderWidth: 2,
    margin: 5,
    padding: 5,
  },
  reviewText: {
    ...tailwind("text-black"),
    flexWrap: "wrap",
    fontSize: 16,
    margin: 2,
  },
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-App.html">App</a></li><li><a href="module-BackButton.html">BackButton</a></li><li><a href="module-Button.html">Button</a></li><li><a href="module-DisplayNotif.html">DisplayNotif</a></li><li><a href="module-Headers.html">Headers</a></li><li><a href="module-LandingScreen.html">LandingScreen</a></li><li><a href="module-ListFromAPI.html">ListFromAPI</a></li><li><a href="module-Login.html">Login</a></li><li><a href="module-MainProfile.html">MainProfile</a></li><li><a href="module-NewsPostScreen.html">NewsPostScreen</a></li><li><a href="module-RecoverAccountScreen.html">RecoverAccountScreen</a></li><li><a href="module-RegisterAccountScreen.html">RegisterAccountScreen</a></li><li><a href="module-ScreenHeader.html">ScreenHeader</a></li><li><a href="module-SearchBar.html">SearchBar</a></li><li><a href="module-SearchScreen.html">SearchScreen</a></li><li><a href="module-ServiceDetails.html">ServiceDetails</a></li><li><a href="module-SettingsScreen.html">SettingsScreen</a></li><li><a href="module-TagRow.html">TagRow</a></li><li><a href="module-TextField.html">TextField</a></li><li><a href="module-TutorialScreen.html">TutorialScreen</a></li><li><a href="module-UnderlinedLink.html">UnderlinedLink</a></li><li><a href="module-WriteReview.html">WriteReview</a></li></ul><h3>Global</h3><ul><li><a href="global.html#capitalize">capitalize</a></li><li><a href="global.html#formatDate">formatDate</a></li><li><a href="global.html#getTags">getTags</a></li><li><a href="global.html#openPhone">openPhone</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Nov 05 2021 19:46:42 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
